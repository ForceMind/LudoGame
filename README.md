# Ludo Battle - AI Challenge 🎲

这是一个基于 HTML5 Canvas 和原生 JavaScript 开发的高级飞行棋（Ludo）游戏。本项目不仅还原了经典的飞行棋玩法，还引入了基于数学模型的智能 AI 对手和实时决策监控系统。

## ✨ 特性 (Features)

### 🎮 核心玩法
- **经典规则**：包含起飞、吃子、安全区、终点直道等标准飞行棋规则。
- **奖励机制**：掷出 6 点、成功吃子或棋子到达终点均可获得额外回合。
- **3D 视觉效果**：使用 Canvas 绘制带有阴影和立体感的棋子，支持平滑的移动动画。
- **移动端适配**：响应式布局，支持手机竖屏游玩，自动调整棋盘大小。
- **智能重叠显示**：当多枚棋子位于同一格时，自动进行分组排列和缩放，确保清晰可见。
- **虚拟经济系统**：内置虚拟货币（豆），玩家可以通过赢得比赛赚取奖金。
- **游戏时长控制**：
  - **智能计时器**：顶部实时显示游戏时长，支持后台暂停功能（切换标签页时自动暂停计时）。
  - **节奏优化**：通过 AI 算法（加权随机骰子）优化游戏节奏，单局时长通常控制在 10 分钟以内。

### 🤖 智能 AI (Smart AI)
- **动态难度调整**：AI 采用 Sigmoid 函数根据当前胜率差值动态调整骰子概率，确保游戏体验的平衡性与挑战性。
- **时间流逝控制**：
  - **发育期 (0-2min)**：降低冲突概率，让玩家平稳开局。
  - **激战期 (2-6min)**：AI 攻击性增强，加快游戏节奏。
  - **收官期 (6min+)**：AI 倾向于快速结束游戏，避免垃圾时间。
- **多维评估体系**：
  - **结构分 (Structure Score)**：评估棋子在棋盘上的分布（基地、路上、安全区、终点）。
  - **进度分 (Progress Score)**：计算所有棋子距离终点的剩余步数。
- **干预机制**：
  - **吃子干预**：当玩家即将被吃时，系统会根据胜率预测进行概率性保护或放行。
  - **终点干预**：在游戏决胜阶段，根据玩家近期的胜率表现微调骰子点数。

### 📊 实时监控 (Real-time Monitoring)
- **决策可视化**：游戏界面左侧实时显示 AI 的决策逻辑。
- **数据透明**：展示当前触发的机制（如“吃子干预”、“Sigmoid A组”）、各玩家预测胜率、影响因子等核心数据。

## 🛠️ 技术栈 (Tech Stack)

- **前端核心**: HTML5, CSS3, Vanilla JavaScript (ES6+)
- **渲染引擎**: HTML5 Canvas API
- **数据存储**: LocalStorage (保存用户余额和战绩)
- **无依赖**: 纯原生代码，无需 Node.js 或构建工具即可运行。

## 🚀 快速开始 (Quick Start)

1. **克隆项目**
   ```bash
   git clone https://github.com/ForceMind/ludo-battle.git
   ```

2. **运行游戏**
   - 直接双击打开 `index.html` 文件即可在浏览器中游玩。
   - 或者使用 VS Code 的 "Live Server" 插件启动。

## 📖 游戏规则 (Rules)

1. **起飞**：必须掷出 **6** 点才能将棋子从基地移动到出发点。
2. **奖励回合**：以下情况可获得额外掷骰子机会：
   - 掷出 **6** 点。
   - 成功 **吃掉** 对手棋子。
   - 棋子成功 **到达终点**。
3. **吃子**：移动到非安全区且已有敌方棋子的格子时，会将敌方棋子撞回基地。
4. **安全区**：带有星号标记的格子及各玩家起飞点为安全区，棋子在此处不会被吃。
5. **获胜条件**：率先将所有 4 枚棋子移动到终点的玩家获胜。

## 📂 项目结构 (Project Structure)

```
LudoGame/
├── css/
│   └── style.css       # 样式文件
├── js/
│   ├── ai.js           # AI 核心逻辑 (胜率计算、骰子控制)
│   ├── game.js         # 游戏主循环与状态管理
│   ├── ludo.js         # 棋盘数据结构与坐标映射
│   ├── player.js       # 玩家类定义
│   ├── ui.js           # Canvas 渲染与 DOM 交互
│   └── utils.js        # 工具函数
├── index.html          # 游戏入口
└── README.md           # 项目说明文档
```

## 📝 开发日志

- **V1.0**: 基础游戏逻辑实现。
- **V2.0**: 引入 AI 胜率预测模型与 Sigmoid 概率控制。
- **V3.0**: UI 全面升级，实现 3D 棋子渲染与动画效果。
- **V3.1**: 增加实时 AI 决策监控面板与安全区视觉标识。
- **V3.2**: 完善游戏规则（吃子/终点奖励），优化棋子重叠显示与终点布局。
- **V3.3**: 
  - 新增游戏计时器与后台自动暂停功能。
  - 优化 AI 骰子逻辑：引入分组加权（80%概率掷出3-5点），显著加快游戏节奏。
  - 修复了部分逻辑导致的白屏问题。

---
Enjoy the game! 🎲
